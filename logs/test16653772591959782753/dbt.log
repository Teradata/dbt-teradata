04:47:40.808581 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:47:40.810321 [debug] [MainThread]: Dropping schema "_ReferenceKey(database=None, schema='test16653772591959782753_test_basic', identifier=None)".
04:47:40.838048 [debug] [MainThread]: Using teradata connection "_test"
04:47:40.839124 [debug] [MainThread]: On _test: 
04:47:40.840122 [debug] [MainThread]: Opening a new connection, currently in state init
04:47:58.661854 [debug] [MainThread]: SQL status: OK in 17.82 seconds
04:47:58.663093 [debug] [MainThread]: Using teradata connection "_test"
04:47:58.664457 [debug] [MainThread]: On _test: DELETE DATABASE /*+ IF EXISTS */ "test16653772591959782753_test_basic" ALL;
04:47:59.070187 [debug] [MainThread]: teradata adapter: Teradata error: [Version 17.20.0.5] [Session 2180] [Teradata Database] [Error 3802] Database 'test16653772591959782753_test_basic' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:88
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:216
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:232
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:803
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2229
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:814
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:673
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1307
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1759
 at database/sql.withLock sql.go:3437
 at database/sql.(*DB).queryDC sql.go:1754
 at database/sql.(*Conn).QueryContext sql.go:2013
 at main.goCreateRows goside.go:666
 at _cgoexp_7cdf4597d74c_goCreateRows _cgo_gotypes.go:340
 at runtime.cgocallbackg1 cgocall.go:314
 at runtime.cgocallbackg cgocall.go:233
 at runtime.cgocallback asm_amd64.s:971
 at runtime.goexit asm_amd64.s:1571
04:47:59.071725 [debug] [MainThread]: On _test: ROLLBACK
04:47:59.383995 [debug] [MainThread]: Using teradata connection "_test"
04:47:59.385039 [debug] [MainThread]: On _test: 
04:47:59.386673 [debug] [MainThread]: SQL status: OK in 0.0 seconds
04:47:59.387267 [debug] [MainThread]: Using teradata connection "_test"
04:47:59.388524 [debug] [MainThread]: On _test: DROP DATABASE /*+ IF EXISTS */ "test16653772591959782753_test_basic";
04:47:59.702452 [debug] [MainThread]: teradata adapter: Teradata error: [Version 17.20.0.5] [Session 2180] [Teradata Database] [Error 3802] Database 'test16653772591959782753_test_basic' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:88
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:216
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:232
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:803
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2229
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:814
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:673
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1307
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1759
 at database/sql.withLock sql.go:3437
 at database/sql.(*DB).queryDC sql.go:1754
 at database/sql.(*Conn).QueryContext sql.go:2013
 at main.goCreateRows goside.go:666
 at _cgoexp_7cdf4597d74c_goCreateRows _cgo_gotypes.go:340
 at runtime.cgocallbackg1 cgocall.go:314
 at runtime.cgocallbackg cgocall.go:233
 at runtime.cgocallback asm_amd64.s:971
 at runtime.goexit asm_amd64.s:1571
04:47:59.703616 [debug] [MainThread]: On _test: ROLLBACK
04:48:00.025105 [debug] [MainThread]: On _test: Close
04:48:00.361630 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:48:00.362150 [debug] [MainThread]: Creating schema "_ReferenceKey(database=None, schema='test16653772591959782753_test_basic', identifier=None)"
04:48:00.368278 [debug] [MainThread]: Using teradata connection "_test"
04:48:00.368884 [debug] [MainThread]: On _test: 
04:48:00.369402 [debug] [MainThread]: Opening a new connection, currently in state closed
04:48:04.101041 [debug] [MainThread]: SQL status: OK in 3.73 seconds
04:48:04.102692 [debug] [MainThread]: Using teradata connection "_test"
04:48:04.103759 [debug] [MainThread]: On _test: CREATE DATABASE "test16653772591959782753_test_basic"
    -- Teradata expects db sizing params on creation. This macro is probably
    -- useful only for testing. For production scenrios, a properly sized
    -- database (schema) will likely exist before dbt gets called
    AS PERMANENT = 60e6, -- 60MB
        SPOOL = 120e6; -- 120MB
04:48:04.907216 [debug] [MainThread]: SQL status: OK in 0.8 seconds
04:48:04.910869 [debug] [MainThread]: On _test: COMMIT
04:48:04.911485 [debug] [MainThread]: Using teradata connection "_test"
04:48:04.913171 [debug] [MainThread]: On _test: COMMIT
04:48:05.232342 [debug] [MainThread]: SQL status: OK in 0.32 seconds
04:48:05.233190 [debug] [MainThread]: On _test: Close
04:48:05.709009 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-10 04:48:05.739811 | 4a2abe90-d4de-4a58-a5b8-c18c57e3a4d2 ==============================
04:48:05.739811 [info ] [MainThread]: Running with dbt=1.1.0
04:48:05.740810 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\vs255034\\AppData\\Local\\Temp\\pytest-of-vs255034\\pytest-20\\profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
04:48:05.742126 [debug] [MainThread]: Tracking: do not track
04:48:05.777428 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
04:48:06.052852 [debug] [MainThread]: Parsing macros\adapters.sql
04:48:06.115085 [debug] [MainThread]: Parsing macros\catalog.sql
04:48:06.141761 [debug] [MainThread]: Parsing macros\materializations\incremental\helpers.sql
04:48:06.149104 [debug] [MainThread]: Parsing macros\materializations\incremental\incremental.sql
04:48:06.169792 [debug] [MainThread]: Parsing macros\materializations\seed\seed.sql
04:48:06.229238 [debug] [MainThread]: Parsing macros\materializations\snapshot\snapshot.sql
04:48:06.339002 [debug] [MainThread]: Parsing macros\materializations\snapshot\snapshot_merge.sql
04:48:06.346663 [debug] [MainThread]: Parsing macros\materializations\snapshot\strategies.sql
04:48:06.350644 [debug] [MainThread]: Parsing macros\materializations\test\test.sql
04:48:06.355580 [debug] [MainThread]: Parsing macros\adapters\columns.sql
04:48:06.393404 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
04:48:06.404098 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
04:48:06.414559 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
04:48:06.440415 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
04:48:06.455871 [debug] [MainThread]: Parsing macros\adapters\relation.sql
04:48:06.488841 [debug] [MainThread]: Parsing macros\adapters\schema.sql
04:48:06.497449 [debug] [MainThread]: Parsing macros\etc\datetime.sql
04:48:06.525038 [debug] [MainThread]: Parsing macros\etc\statement.sql
04:48:06.539996 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
04:48:06.544033 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
04:48:06.545900 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
04:48:06.548298 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
04:48:06.550153 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
04:48:06.553715 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
04:48:06.557330 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
04:48:06.562967 [debug] [MainThread]: Parsing macros\materializations\configs.sql
04:48:06.565097 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
04:48:06.577025 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
04:48:06.588877 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
04:48:06.615477 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
04:48:06.619650 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
04:48:06.659442 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
04:48:06.698164 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
04:48:06.706392 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
04:48:06.725235 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
04:48:06.732699 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
04:48:06.739588 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
04:48:06.743265 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
04:48:06.755521 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
04:48:06.776122 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
04:48:06.784683 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
04:48:06.803702 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
04:48:06.822742 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
04:48:06.826341 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
04:48:06.866313 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
04:48:06.872076 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
04:48:06.884079 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
04:48:06.888853 [debug] [MainThread]: Parsing tests\generic\builtin.sql
04:48:07.562074 [info ] [MainThread]: Found 0 models, 0 tests, 3 snapshots, 0 analyses, 181 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
04:48:07.564096 [info ] [MainThread]: 
04:48:07.564925 [debug] [MainThread]: Acquiring new teradata connection "master"
04:48:07.568258 [debug] [ThreadPool]: Acquiring new teradata connection "list_schemas"
04:48:07.578514 [debug] [ThreadPool]: Using teradata connection "list_schemas"
04:48:07.578514 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:48:07.579511 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:48:11.542005 [debug] [ThreadPool]: SQL status: OK in 3.96 seconds
04:48:11.547028 [debug] [ThreadPool]: On list_schemas: Close
04:48:11.876555 [debug] [ThreadPool]: Acquiring new teradata connection "list_None_test16653772591959782753_test_basic"
04:48:11.890903 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:48:11.892278 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: 
04:48:11.892810 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:48:15.162587 [debug] [ThreadPool]: SQL status: OK in 3.27 seconds
04:48:15.163742 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:48:15.164823 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_None_test16653772591959782753_test_basic"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
04:48:15.832231 [debug] [ThreadPool]: SQL status: OK in 0.67 seconds
04:48:15.835552 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: ROLLBACK
04:48:16.151937 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: Close
04:48:16.472418 [debug] [MainThread]: Using teradata connection "master"
04:48:16.472937 [debug] [MainThread]: On master: 
04:48:16.473972 [debug] [MainThread]: Opening a new connection, currently in state init
04:48:19.702931 [debug] [MainThread]: SQL status: OK in 3.23 seconds
04:48:19.704001 [debug] [MainThread]: On master: COMMIT
04:48:19.705341 [debug] [MainThread]: Using teradata connection "master"
04:48:19.706499 [debug] [MainThread]: On master: COMMIT
04:48:20.022562 [debug] [MainThread]: SQL status: OK in 0.32 seconds
04:48:20.023694 [debug] [MainThread]: On master: Close
04:48:20.369826 [info ] [MainThread]: Concurrency: 1 threads (target='default')
04:48:20.370763 [info ] [MainThread]: 
04:48:20.395550 [debug] [Thread-1  ]: Began running node seed.snapshot_strategy_check_cols.added
04:48:20.396549 [info ] [Thread-1  ]: 1 of 2 START seed file test16653772591959782753_test_basic.added ............... [RUN]
04:48:20.399168 [debug] [Thread-1  ]: Acquiring new teradata connection "seed.snapshot_strategy_check_cols.added"
04:48:20.399168 [debug] [Thread-1  ]: Began compiling node seed.snapshot_strategy_check_cols.added
04:48:20.400165 [debug] [Thread-1  ]: finished collecting timing info
04:48:20.401161 [debug] [Thread-1  ]: Began executing node seed.snapshot_strategy_check_cols.added
04:48:20.478161 [debug] [Thread-1  ]: model : {'raw_sql': '', 'resource_type': 'seed', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'tags': [], 'meta': {}, 'materialized': 'seed', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'on_schema_change': 'ignore', 'post-hook': [], 'pre-hook': []}, 'schema': 'test16653772591959782753_test_basic', 'fqn': ['snapshot_strategy_check_cols', 'added'], 'unique_id': 'seed.snapshot_strategy_check_cols.added', 'package_name': 'snapshot_strategy_check_cols', 'root_path': 'C:\\Users\\vs255034\\AppData\\Local\\Temp\\pytest-of-vs255034\\pytest-20\\project0', 'path': 'added.csv', 'original_file_path': 'seeds\\added.csv', 'name': 'added', 'alias': 'added', 'checksum': {'name': 'sha256', 'checksum': 'a3d9dd9bfad23ea273491e1e26380b03d4cac45a27dd4e9199dedaeb77c12cbd'}, 'tags': [], 'refs': [], 'sources': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'deferred': False, 'unrendered_config': {}, 'created_at': 1665377287.5220795}
04:48:20.479619 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.added"
04:48:20.480031 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.added: 
04:48:20.481028 [debug] [Thread-1  ]: Opening a new connection, currently in state init
04:48:23.818667 [debug] [Thread-1  ]: SQL status: OK in 3.34 seconds
04:48:23.819768 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.added"
04:48:23.820302 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.added: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "seed.snapshot_strategy_check_cols.added"} */

    
    CREATE  TABLE "test16653772591959782753_test_basic"."added"
    
    ("id" INTEGER,"name" LONG VARCHAR,"some_date" TIMESTAMP(0))
    ;

  
04:48:24.567806 [debug] [Thread-1  ]: SQL status: OK in 0.75 seconds
04:48:24.610623 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.added"
04:48:24.611619 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.added: insert into "test16653772591959782753_test_basic"."added" ("id", "name", "some_date") values
                (?,?,?)
        ...
04:48:25.285322 [debug] [Thread-1  ]: SQL status: OK in 0.67 seconds
04:48:25.294762 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.snapshot_strategy_check_cols.added"
04:48:25.315814 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.added: COMMIT
04:48:25.317073 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.added"
04:48:25.318073 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.added: COMMIT
04:48:25.632195 [debug] [Thread-1  ]: SQL status: OK in 0.31 seconds
04:48:25.633909 [debug] [Thread-1  ]: finished collecting timing info
04:48:25.634575 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.added: Close
04:48:26.001963 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file test16653772591959782753_test_basic.added ........... [[32mINSERT 20[0m in 5.60s]
04:48:26.004061 [debug] [Thread-1  ]: Finished running node seed.snapshot_strategy_check_cols.added
04:48:26.005783 [debug] [Thread-1  ]: Began running node seed.snapshot_strategy_check_cols.base
04:48:26.007506 [info ] [Thread-1  ]: 2 of 2 START seed file test16653772591959782753_test_basic.base ................ [RUN]
04:48:26.015167 [debug] [Thread-1  ]: Acquiring new teradata connection "seed.snapshot_strategy_check_cols.base"
04:48:26.016169 [debug] [Thread-1  ]: Began compiling node seed.snapshot_strategy_check_cols.base
04:48:26.017167 [debug] [Thread-1  ]: finished collecting timing info
04:48:26.018211 [debug] [Thread-1  ]: Began executing node seed.snapshot_strategy_check_cols.base
04:48:26.028637 [debug] [Thread-1  ]: model : {'raw_sql': '', 'resource_type': 'seed', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'tags': [], 'meta': {}, 'materialized': 'seed', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'on_schema_change': 'ignore', 'post-hook': [], 'pre-hook': []}, 'schema': 'test16653772591959782753_test_basic', 'fqn': ['snapshot_strategy_check_cols', 'base'], 'unique_id': 'seed.snapshot_strategy_check_cols.base', 'package_name': 'snapshot_strategy_check_cols', 'root_path': 'C:\\Users\\vs255034\\AppData\\Local\\Temp\\pytest-of-vs255034\\pytest-20\\project0', 'path': 'base.csv', 'original_file_path': 'seeds\\base.csv', 'name': 'base', 'alias': 'base', 'checksum': {'name': 'sha256', 'checksum': '86dc7fd6521185b45bd27b5f5d2c808d6b61781ee713e439016f1ebc221c955d'}, 'tags': [], 'refs': [], 'sources': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'deferred': False, 'unrendered_config': {}, 'created_at': 1665377287.5252633}
04:48:26.030204 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.base"
04:48:26.031620 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.base: 
04:48:26.032622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
04:48:29.585600 [debug] [Thread-1  ]: SQL status: OK in 3.55 seconds
04:48:29.586831 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.base"
04:48:29.587992 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.base: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "seed.snapshot_strategy_check_cols.base"} */

    
    CREATE  TABLE "test16653772591959782753_test_basic"."base"
    
    ("id" INTEGER,"name" LONG VARCHAR,"some_date" TIMESTAMP(0))
    ;

  
04:48:30.408077 [debug] [Thread-1  ]: SQL status: OK in 0.82 seconds
04:48:30.412961 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.base"
04:48:30.413540 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.base: insert into "test16653772591959782753_test_basic"."base" ("id", "name", "some_date") values
                (?,?,?)
        ...
04:48:31.121657 [debug] [Thread-1  ]: SQL status: OK in 0.71 seconds
04:48:31.123921 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.snapshot_strategy_check_cols.base"
04:48:31.131338 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.base: COMMIT
04:48:31.132249 [debug] [Thread-1  ]: Using teradata connection "seed.snapshot_strategy_check_cols.base"
04:48:31.133794 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.base: COMMIT
04:48:31.453076 [debug] [Thread-1  ]: SQL status: OK in 0.32 seconds
04:48:31.454617 [debug] [Thread-1  ]: finished collecting timing info
04:48:31.455766 [debug] [Thread-1  ]: On seed.snapshot_strategy_check_cols.base: Close
04:48:31.782513 [info ] [Thread-1  ]: 2 of 2 OK loaded seed file test16653772591959782753_test_basic.base ............ [[32mINSERT 10[0m in 5.77s]
04:48:31.783078 [debug] [Thread-1  ]: Finished running node seed.snapshot_strategy_check_cols.base
04:48:31.784725 [debug] [MainThread]: Acquiring new teradata connection "master"
04:48:31.785247 [debug] [MainThread]: Using teradata connection "master"
04:48:31.785806 [debug] [MainThread]: On master: 
04:48:31.786326 [debug] [MainThread]: Opening a new connection, currently in state closed
04:48:35.422446 [debug] [MainThread]: SQL status: OK in 3.64 seconds
04:48:35.423580 [debug] [MainThread]: On master: COMMIT
04:48:35.424378 [debug] [MainThread]: Using teradata connection "master"
04:48:35.425138 [debug] [MainThread]: On master: COMMIT
04:48:35.742092 [debug] [MainThread]: SQL status: OK in 0.32 seconds
04:48:35.742643 [debug] [MainThread]: On master: Close
04:48:36.063262 [info ] [MainThread]: 
04:48:36.064431 [info ] [MainThread]: Finished running 2 seeds in 28.50s.
04:48:36.065580 [debug] [MainThread]: Connection 'master' was properly closed.
04:48:36.066167 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
04:48:36.067315 [debug] [MainThread]: Connection 'list_None_test16653772591959782753_test_basic' was properly closed.
04:48:36.068477 [debug] [MainThread]: Connection 'seed.snapshot_strategy_check_cols.base' was properly closed.
04:48:36.083291 [info ] [MainThread]: 
04:48:36.084288 [info ] [MainThread]: [32mCompleted successfully[0m
04:48:36.085008 [info ] [MainThread]: 
04:48:36.086487 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2


============================== 2022-10-10 04:48:36.163432 | 4a2abe90-d4de-4a58-a5b8-c18c57e3a4d2 ==============================
04:48:36.163432 [info ] [MainThread]: Running with dbt=1.1.0
04:48:36.164435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\vs255034\\AppData\\Local\\Temp\\pytest-of-vs255034\\pytest-20\\profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
04:48:36.165463 [debug] [MainThread]: Tracking: do not track
04:48:36.331148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
04:48:36.332192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
04:48:36.356497 [info ] [MainThread]: Found 0 models, 0 tests, 3 snapshots, 0 analyses, 181 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
04:48:36.358993 [info ] [MainThread]: 
04:48:36.360219 [debug] [MainThread]: Acquiring new teradata connection "master"
04:48:36.362512 [debug] [ThreadPool]: Acquiring new teradata connection "list_schemas"
04:48:36.368605 [debug] [ThreadPool]: Using teradata connection "list_schemas"
04:48:36.369602 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:48:36.370810 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:48:40.337935 [debug] [ThreadPool]: SQL status: OK in 3.97 seconds
04:48:40.345093 [debug] [ThreadPool]: On list_schemas: Close
04:48:40.748078 [debug] [ThreadPool]: Acquiring new teradata connection "list_None_test16653772591959782753_test_basic"
04:48:40.753253 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:48:40.753289 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: 
04:48:40.753806 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:48:44.228877 [debug] [ThreadPool]: SQL status: OK in 3.48 seconds
04:48:44.229751 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:48:44.230837 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_None_test16653772591959782753_test_basic"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
04:48:45.048464 [debug] [ThreadPool]: SQL status: OK in 0.82 seconds
04:48:45.052112 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: ROLLBACK
04:48:45.362436 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: Close
04:48:45.694690 [debug] [MainThread]: Using teradata connection "master"
04:48:45.696638 [debug] [MainThread]: On master: 
04:48:45.698951 [debug] [MainThread]: Opening a new connection, currently in state init
04:48:49.451071 [debug] [MainThread]: SQL status: OK in 3.75 seconds
04:48:49.451592 [debug] [MainThread]: On master: COMMIT
04:48:49.452149 [debug] [MainThread]: Using teradata connection "master"
04:48:49.452149 [debug] [MainThread]: On master: COMMIT
04:48:49.860983 [debug] [MainThread]: SQL status: OK in 0.41 seconds
04:48:49.862749 [debug] [MainThread]: On master: Close
04:48:50.195169 [info ] [MainThread]: Concurrency: 1 threads (target='default')
04:48:50.197248 [info ] [MainThread]: 
04:48:50.204024 [debug] [Thread-5  ]: Began running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:48:50.206839 [info ] [Thread-5  ]: 1 of 3 START snapshot test16653772591959782753_test_basic.cc_all_snapshot ...... [RUN]
04:48:50.208960 [debug] [Thread-5  ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:50.209964 [debug] [Thread-5  ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:48:50.210961 [debug] [Thread-5  ]: Compiling snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:48:50.222607 [debug] [Thread-5  ]: finished collecting timing info
04:48:50.224599 [debug] [Thread-5  ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:48:50.260596 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:50.261041 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:48:50.261041 [debug] [Thread-5  ]: Opening a new connection, currently in state init
04:48:54.366342 [debug] [Thread-5  ]: SQL status: OK in 4.11 seconds
04:48:54.408162 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:54.409391 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:48:55.186068 [debug] [Thread-5  ]: SQL status: OK in 0.78 seconds
04:48:55.238865 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:55.239862 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT * FROM (
            
    
    select * from "test16653772591959782753_test_basic"."base"
        ) AS __dbt_sbq
        WHERE 0=1
    
04:48:56.004420 [debug] [Thread-5  ]: SQL status: OK in 0.76 seconds
04:48:56.039573 [debug] [Thread-5  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:56.040810 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:56.042161 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: 
04:48:56.042734 [debug] [Thread-5  ]: SQL status: OK in 0.0 seconds
04:48:56.043254 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:56.043763 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

          
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_all_snapshot"
  
    AS (
        

    SELECT sbq.*,
        HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:48:52.970000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id,
        TO_TIMESTAMP_TZ('2022-10-09 21:48:52.970000+00:00') AS dbt_updated_at,
        TO_TIMESTAMP_TZ('2022-10-09 21:48:52.970000+00:00') AS dbt_valid_from,
        nullif(TO_TIMESTAMP_TZ('2022-10-09 21:48:52.970000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:48:52.970000+00:00')) AS dbt_valid_to
    FROM (
        
    
    select * from "test16653772591959782753_test_basic"."base"
    ) AS sbq


      ) WITH DATA
  
  ;


      
04:48:58.974996 [debug] [Thread-5  ]: SQL status: OK in 2.93 seconds
04:48:58.979020 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
04:48:58.979879 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:48:58.981067 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
04:48:59.384204 [debug] [Thread-5  ]: SQL status: OK in 0.4 seconds
04:48:59.385240 [debug] [Thread-5  ]: finished collecting timing info
04:48:59.423424 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: Close
04:48:59.794773 [info ] [Thread-5  ]: 1 of 3 OK snapshotted test16653772591959782753_test_basic.cc_all_snapshot ...... [[32mOK[0m in 9.59s]
04:48:59.796391 [debug] [Thread-5  ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:48:59.797463 [debug] [Thread-5  ]: Began running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:48:59.798782 [info ] [Thread-5  ]: 2 of 3 START snapshot test16653772591959782753_test_basic.cc_date_snapshot ..... [RUN]
04:48:59.800279 [debug] [Thread-5  ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:48:59.801377 [debug] [Thread-5  ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:48:59.802563 [debug] [Thread-5  ]: Compiling snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:48:59.811288 [debug] [Thread-5  ]: finished collecting timing info
04:48:59.812681 [debug] [Thread-5  ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:48:59.819580 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:48:59.820261 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:48:59.821253 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
04:49:03.662509 [debug] [Thread-5  ]: SQL status: OK in 3.84 seconds
04:49:03.680682 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:49:03.682146 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:49:04.401588 [debug] [Thread-5  ]: SQL status: OK in 0.72 seconds
04:49:04.404945 [debug] [Thread-5  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:49:04.406674 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:49:04.407242 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: 
04:49:04.407772 [debug] [Thread-5  ]: SQL status: OK in 0.0 seconds
04:49:04.408491 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:49:04.408580 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

          
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_date_snapshot"
  
    AS (
        

    SELECT sbq.*,
        HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:49:02.250000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id,
        TO_TIMESTAMP_TZ('2022-10-09 21:49:02.250000+00:00') AS dbt_updated_at,
        TO_TIMESTAMP_TZ('2022-10-09 21:49:02.250000+00:00') AS dbt_valid_from,
        nullif(TO_TIMESTAMP_TZ('2022-10-09 21:49:02.250000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:49:02.250000+00:00')) AS dbt_valid_to
    FROM (
        
    
    select * from "test16653772591959782753_test_basic"."base"
    ) AS sbq


      ) WITH DATA
  
  ;


      
04:49:05.132447 [debug] [Thread-5  ]: SQL status: OK in 0.72 seconds
04:49:05.135950 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
04:49:05.137077 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:49:05.138204 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
04:49:05.452793 [debug] [Thread-5  ]: SQL status: OK in 0.31 seconds
04:49:05.455228 [debug] [Thread-5  ]: finished collecting timing info
04:49:05.456444 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: Close
04:49:05.793286 [info ] [Thread-5  ]: 2 of 3 OK snapshotted test16653772591959782753_test_basic.cc_date_snapshot ..... [[32mOK[0m in 5.99s]
04:49:05.793952 [debug] [Thread-5  ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:49:05.794502 [debug] [Thread-5  ]: Began running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:49:05.795610 [info ] [Thread-5  ]: 3 of 3 START snapshot test16653772591959782753_test_basic.cc_name_snapshot ..... [RUN]
04:49:05.796676 [debug] [Thread-5  ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:49:05.797239 [debug] [Thread-5  ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:49:05.797788 [debug] [Thread-5  ]: Compiling snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:49:05.804645 [debug] [Thread-5  ]: finished collecting timing info
04:49:05.805852 [debug] [Thread-5  ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:49:05.811676 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:49:05.812341 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:49:05.812341 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
04:49:09.792666 [debug] [Thread-5  ]: SQL status: OK in 3.98 seconds
04:49:09.797969 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:49:09.798252 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:49:10.443662 [debug] [Thread-5  ]: SQL status: OK in 0.64 seconds
04:49:10.448572 [debug] [Thread-5  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:49:10.451094 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:49:10.451636 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: 
04:49:10.452709 [debug] [Thread-5  ]: SQL status: OK in 0.0 seconds
04:49:10.453317 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:49:10.453834 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

          
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_name_snapshot"
  
    AS (
        

    SELECT sbq.*,
        HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:49:08.360000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id,
        TO_TIMESTAMP_TZ('2022-10-09 21:49:08.360000+00:00') AS dbt_updated_at,
        TO_TIMESTAMP_TZ('2022-10-09 21:49:08.360000+00:00') AS dbt_valid_from,
        nullif(TO_TIMESTAMP_TZ('2022-10-09 21:49:08.360000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:49:08.360000+00:00')) AS dbt_valid_to
    FROM (
        
    
    select * from "test16653772591959782753_test_basic"."base"
    ) AS sbq


      ) WITH DATA
  
  ;


      
04:49:11.162682 [debug] [Thread-5  ]: SQL status: OK in 0.71 seconds
04:49:11.166131 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
04:49:11.167240 [debug] [Thread-5  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:49:11.168903 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
04:49:11.485221 [debug] [Thread-5  ]: SQL status: OK in 0.32 seconds
04:49:11.487366 [debug] [Thread-5  ]: finished collecting timing info
04:49:11.488445 [debug] [Thread-5  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: Close
04:49:11.835344 [info ] [Thread-5  ]: 3 of 3 OK snapshotted test16653772591959782753_test_basic.cc_name_snapshot ..... [[32mOK[0m in 6.04s]
04:49:11.837321 [debug] [Thread-5  ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:49:11.839623 [debug] [MainThread]: Acquiring new teradata connection "master"
04:49:11.840786 [debug] [MainThread]: Using teradata connection "master"
04:49:11.841938 [debug] [MainThread]: On master: 
04:49:11.843045 [debug] [MainThread]: Opening a new connection, currently in state closed
04:49:15.564089 [debug] [MainThread]: SQL status: OK in 3.72 seconds
04:49:15.565614 [debug] [MainThread]: On master: COMMIT
04:49:15.566642 [debug] [MainThread]: Using teradata connection "master"
04:49:15.567686 [debug] [MainThread]: On master: COMMIT
04:49:15.973322 [debug] [MainThread]: SQL status: OK in 0.4 seconds
04:49:15.977124 [debug] [MainThread]: On master: Close
04:49:16.383712 [info ] [MainThread]: 
04:49:16.385202 [info ] [MainThread]: Finished running 3 snapshots in 40.02s.
04:49:16.386843 [debug] [MainThread]: Connection 'master' was properly closed.
04:49:16.387436 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
04:49:16.388023 [debug] [MainThread]: Connection 'list_None_test16653772591959782753_test_basic' was properly closed.
04:49:16.389131 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_name_snapshot' was properly closed.
04:49:16.399935 [info ] [MainThread]: 
04:49:16.401660 [info ] [MainThread]: [32mCompleted successfully[0m
04:49:16.402563 [info ] [MainThread]: 
04:49:16.404090 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
04:49:16.406635 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:49:16.407636 [debug] [MainThread]: Opening a new connection, currently in state init
04:49:20.745609 [debug] [MainThread]: On _test: Close
04:49:21.094174 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:49:21.094694 [debug] [MainThread]: Opening a new connection, currently in state closed
04:49:25.042762 [debug] [MainThread]: On _test: Close
04:49:25.404793 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:49:25.405897 [debug] [MainThread]: Opening a new connection, currently in state closed
04:49:29.344626 [debug] [MainThread]: On _test: Close
04:49:29.672426 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:49:29.672970 [debug] [MainThread]: Opening a new connection, currently in state closed
04:49:34.101023 [debug] [MainThread]: On _test: Close
04:49:34.494348 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-10 04:49:34.515646 | 4a2abe90-d4de-4a58-a5b8-c18c57e3a4d2 ==============================
04:49:34.515646 [info ] [MainThread]: Running with dbt=1.1.0
04:49:34.516678 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': False, 'static_parser': True, 'profiles_dir': 'C:\\Users\\vs255034\\AppData\\Local\\Temp\\pytest-of-vs255034\\pytest-20\\profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': 'seed_name: added', 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
04:49:34.517640 [debug] [MainThread]: Tracking: do not track
04:49:34.532306 [debug] [MainThread]: Partial parsing not enabled
04:49:34.586434 [debug] [MainThread]: Parsing macros\adapters.sql
04:49:34.608597 [debug] [MainThread]: Parsing macros\catalog.sql
04:49:34.618653 [debug] [MainThread]: Parsing macros\materializations\incremental\helpers.sql
04:49:34.621368 [debug] [MainThread]: Parsing macros\materializations\incremental\incremental.sql
04:49:34.628718 [debug] [MainThread]: Parsing macros\materializations\seed\seed.sql
04:49:34.651144 [debug] [MainThread]: Parsing macros\materializations\snapshot\snapshot.sql
04:49:34.692790 [debug] [MainThread]: Parsing macros\materializations\snapshot\snapshot_merge.sql
04:49:34.694785 [debug] [MainThread]: Parsing macros\materializations\snapshot\strategies.sql
04:49:34.696343 [debug] [MainThread]: Parsing macros\materializations\test\test.sql
04:49:34.698988 [debug] [MainThread]: Parsing macros\adapters\columns.sql
04:49:34.710629 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
04:49:34.714940 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
04:49:34.716936 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
04:49:34.727528 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
04:49:34.733838 [debug] [MainThread]: Parsing macros\adapters\relation.sql
04:49:34.748277 [debug] [MainThread]: Parsing macros\adapters\schema.sql
04:49:34.751118 [debug] [MainThread]: Parsing macros\etc\datetime.sql
04:49:34.765643 [debug] [MainThread]: Parsing macros\etc\statement.sql
04:49:34.771156 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
04:49:34.773240 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
04:49:34.774230 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
04:49:34.775529 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
04:49:34.776585 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
04:49:34.779223 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
04:49:34.781545 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
04:49:34.783819 [debug] [MainThread]: Parsing macros\materializations\configs.sql
04:49:34.787766 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
04:49:34.792136 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
04:49:34.797558 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
04:49:34.809698 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
04:49:34.812752 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
04:49:34.832607 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
04:49:34.854898 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
04:49:34.859885 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
04:49:34.875631 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
04:49:34.881910 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
04:49:34.886774 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
04:49:34.888997 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
04:49:34.897711 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
04:49:34.921776 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
04:49:34.926806 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
04:49:34.944633 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
04:49:34.957680 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
04:49:34.959976 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
04:49:34.988955 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
04:49:34.994213 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
04:49:35.001519 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
04:49:35.008294 [debug] [MainThread]: Parsing tests\generic\builtin.sql
04:49:35.472398 [info ] [MainThread]: Found 0 models, 0 tests, 3 snapshots, 0 analyses, 181 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
04:49:35.474421 [info ] [MainThread]: 
04:49:35.474421 [debug] [MainThread]: Acquiring new teradata connection "master"
04:49:35.476273 [debug] [ThreadPool]: Acquiring new teradata connection "list_schemas"
04:49:35.478260 [debug] [ThreadPool]: Using teradata connection "list_schemas"
04:49:35.479257 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:49:35.479257 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:49:39.525865 [debug] [ThreadPool]: SQL status: OK in 4.05 seconds
04:49:39.528075 [debug] [ThreadPool]: On list_schemas: Close
04:49:39.943366 [debug] [ThreadPool]: Acquiring new teradata connection "list_None_test16653772591959782753_test_basic"
04:49:39.945575 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:49:39.946397 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: 
04:49:39.946397 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:49:43.523985 [debug] [ThreadPool]: SQL status: OK in 3.58 seconds
04:49:43.524494 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:49:43.525049 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_None_test16653772591959782753_test_basic"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
04:49:44.338831 [debug] [ThreadPool]: SQL status: OK in 0.81 seconds
04:49:44.342484 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: ROLLBACK
04:49:44.748396 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: Close
04:49:45.158526 [debug] [MainThread]: Using teradata connection "master"
04:49:45.158622 [debug] [MainThread]: On master: 
04:49:45.159180 [debug] [MainThread]: Opening a new connection, currently in state init
04:49:48.844981 [debug] [MainThread]: SQL status: OK in 3.69 seconds
04:49:48.845538 [debug] [MainThread]: On master: COMMIT
04:49:48.846048 [debug] [MainThread]: Using teradata connection "master"
04:49:48.846106 [debug] [MainThread]: On master: COMMIT
04:49:49.253947 [debug] [MainThread]: SQL status: OK in 0.41 seconds
04:49:49.254460 [debug] [MainThread]: On master: Close
04:49:49.603690 [info ] [MainThread]: Concurrency: 1 threads (target='default')
04:49:49.604471 [info ] [MainThread]: 
04:49:49.606693 [debug] [Thread-9  ]: Began running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:49:49.607478 [info ] [Thread-9  ]: 1 of 3 START snapshot test16653772591959782753_test_basic.cc_all_snapshot ...... [RUN]
04:49:49.608582 [debug] [Thread-9  ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:49.609137 [debug] [Thread-9  ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:49:49.609137 [debug] [Thread-9  ]: Compiling snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:49:49.612995 [debug] [Thread-9  ]: finished collecting timing info
04:49:49.613571 [debug] [Thread-9  ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:49:49.616251 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:49.617547 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:49:49.617547 [debug] [Thread-9  ]: Opening a new connection, currently in state init
04:49:53.964398 [debug] [Thread-9  ]: SQL status: OK in 4.35 seconds
04:49:53.968273 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:53.968810 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:49:54.787207 [debug] [Thread-9  ]: SQL status: OK in 0.82 seconds
04:49:54.792513 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:54.793068 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT * FROM (
            
    
    select * from "test16653772591959782753_test_basic"."added"
        ) AS __dbt_sbq
        WHERE 0=1
    
04:49:55.705411 [debug] [Thread-9  ]: SQL status: OK in 0.91 seconds
04:49:55.708205 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:55.708772 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT * FROM (
            SELECT * FROM "test16653772591959782753_test_basic"."cc_all_snapshot"
        ) AS __dbt_sbq
        WHERE 0=1
    
04:49:56.422873 [debug] [Thread-9  ]: SQL status: OK in 0.71 seconds
04:49:56.449213 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:56.450810 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
DROP table /*+ IF EXISTS */ "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp";
04:49:56.762703 [debug] [Thread-9  ]: teradata adapter: Teradata error: [Version 17.20.0.5] [Session 2202] [Teradata Database] [Error 3807] Object 'test16653772591959782753_test_basic.cc_all_snapshot__dbt_tmp' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:88
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:216
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:232
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:803
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2229
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:814
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:673
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1307
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1759
 at database/sql.withLock sql.go:3437
 at database/sql.(*DB).queryDC sql.go:1754
 at database/sql.(*Conn).QueryContext sql.go:2013
 at main.goCreateRows goside.go:666
 at _cgoexp_7cdf4597d74c_goCreateRows _cgo_gotypes.go:340
 at runtime.cgocallbackg1 cgocall.go:314
 at runtime.cgocallbackg cgocall.go:233
 at runtime.cgocallback asm_amd64.s:971
 at runtime.goexit asm_amd64.s:1571
04:49:56.773233 [debug] [Thread-9  ]: use_qvci set to : false
04:49:56.774737 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:56.774737 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: 
04:49:56.775917 [debug] [Thread-9  ]: SQL status: OK in 0.0 seconds
04:49:56.775917 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:56.776476 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:49:57.753153 [debug] [Thread-9  ]: SQL status: OK in 0.98 seconds
04:49:57.765372 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:57.766589 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

        
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp"
  
    AS (
      SELECT * FROM (
        WITH snapshot_query AS (

        
    
    select * from "test16653772591959782753_test_basic"."added"

    ),

    snapshotted_data AS (

        SELECT snapshot.*,
            id AS dbt_unique_key

        FROM "test16653772591959782753_test_basic"."cc_all_snapshot" AS snapshot

    ),

    insertions_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00') AS dbt_valid_from,
            nullif(TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00')) AS dbt_valid_to,
            HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id

        FROM snapshot_query
    ),

    updates_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00') AS dbt_valid_from,
            TO_TIMESTAMP_TZ('2022-10-09 21:49:52.530000+00:00') AS dbt_valid_to

        FROM snapshot_query
    ),

    insertions AS (

        SELECT
            'insert' AS dbt_change_type,
            source_data.*

        FROM insertions_source_data AS source_data
        LEFT OUTER JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_unique_key IS NULL
           OR (
                snapshotted_data.dbt_unique_key IS NOT NULL
            AND snapshotted_data.dbt_valid_to IS NULL
            AND (
                (snapshotted_data.id <> source_data.id
        or
        (
            ((snapshotted_data.id IS NULL) AND NOT (source_data.id IS NULL))
            OR
            ((NOT snapshotted_data.id IS NULL) AND (source_data.id IS NULL))
        ) OR snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ) OR snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
            )
        )

    ),

    updates AS (

        SELECT
            'update' AS dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        FROM updates_source_data AS source_data
        JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_valid_to IS NULL
        AND (
            (snapshotted_data.id <> source_data.id
        or
        (
            ((snapshotted_data.id IS NULL) AND NOT (source_data.id IS NULL))
            OR
            ((NOT snapshotted_data.id IS NULL) AND (source_data.id IS NULL))
        ) OR snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ) OR snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
        )
    )

    SELECT * FROM insertions
    UNION ALL
    SELECT * FROM updates
      ) D
    ) WITH DATA
  
  ;


    
04:49:58.578191 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:49:58.581414 [debug] [Thread-9  ]: use_qvci set to : false
04:49:58.583164 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:58.583164 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:49:59.443510 [debug] [Thread-9  ]: SQL status: OK in 0.86 seconds
04:49:59.446867 [debug] [Thread-9  ]: use_qvci set to : false
04:49:59.448531 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:49:59.449047 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:00.312929 [debug] [Thread-9  ]: SQL status: OK in 0.86 seconds
04:50:00.317248 [debug] [Thread-9  ]: use_qvci set to : false
04:50:00.318358 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:00.318989 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:01.142643 [debug] [Thread-9  ]: SQL status: OK in 0.82 seconds
04:50:01.146523 [debug] [Thread-9  ]: use_qvci set to : false
04:50:01.147646 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:01.148299 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:01.792995 [debug] [Thread-9  ]: SQL status: OK in 0.64 seconds
04:50:01.801904 [debug] [Thread-9  ]: use_qvci set to : false
04:50:01.803100 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:01.803654 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:02.472859 [debug] [Thread-9  ]: SQL status: OK in 0.67 seconds
04:50:02.480057 [debug] [Thread-9  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:02.481202 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:02.481779 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

          UPDATE "test16653772591959782753_test_basic"."cc_all_snapshot"
    FROM (SELECT dbt_scd_id, dbt_change_type, dbt_valid_to FROM "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp") AS DBT_INTERNAL_SOURCE
    SET dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    WHERE DBT_INTERNAL_SOURCE.dbt_scd_id = "test16653772591959782753_test_basic"."cc_all_snapshot".dbt_scd_id
      AND DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
      AND "test16653772591959782753_test_basic"."cc_all_snapshot".dbt_valid_to IS NULL

      
04:50:03.152801 [debug] [Thread-9  ]: SQL status: OK in 0.67 seconds
04:50:03.153909 [debug] [Thread-9  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:03.155258 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:03.155765 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

          INSERT INTO "test16653772591959782753_test_basic"."cc_all_snapshot" ("id", "name", "some_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    SELECT DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."some_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    FROM "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp" AS DBT_INTERNAL_SOURCE
    WHERE DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
04:50:03.902738 [debug] [Thread-9  ]: SQL status: OK in 0.75 seconds
04:50:03.904402 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
04:50:03.904997 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:50:03.904997 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
04:50:04.307264 [debug] [Thread-9  ]: SQL status: OK in 0.4 seconds
04:50:04.312269 [debug] [Thread-9  ]: finished collecting timing info
04:50:04.312858 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: Close
04:50:04.717210 [info ] [Thread-9  ]: 1 of 3 OK snapshotted test16653772591959782753_test_basic.cc_all_snapshot ...... [[32mOK[0m in 15.11s]
04:50:04.717634 [debug] [Thread-9  ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:50:04.718172 [debug] [Thread-9  ]: Began running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:50:04.718723 [info ] [Thread-9  ]: 2 of 3 START snapshot test16653772591959782753_test_basic.cc_date_snapshot ..... [RUN]
04:50:04.719831 [debug] [Thread-9  ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:04.719831 [debug] [Thread-9  ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:50:04.720380 [debug] [Thread-9  ]: Compiling snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:50:04.724498 [debug] [Thread-9  ]: finished collecting timing info
04:50:04.725046 [debug] [Thread-9  ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:50:04.728056 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:04.728056 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:50:04.729065 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
04:50:08.974881 [debug] [Thread-9  ]: SQL status: OK in 4.25 seconds
04:50:08.978824 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:08.979385 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:50:09.649998 [debug] [Thread-9  ]: SQL status: OK in 0.67 seconds
04:50:09.654456 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:09.654456 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
DROP table /*+ IF EXISTS */ "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp";
04:50:09.973189 [debug] [Thread-9  ]: teradata adapter: Teradata error: [Version 17.20.0.5] [Session 2203] [Teradata Database] [Error 3807] Object 'test16653772591959782753_test_basic.cc_date_snapshot__dbt_tmp' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:88
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:216
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:232
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:803
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2229
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:814
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:673
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1307
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1759
 at database/sql.withLock sql.go:3437
 at database/sql.(*DB).queryDC sql.go:1754
 at database/sql.(*Conn).QueryContext sql.go:2013
 at main.goCreateRows goside.go:666
 at _cgoexp_7cdf4597d74c_goCreateRows _cgo_gotypes.go:340
 at runtime.cgocallbackg1 cgocall.go:314
 at runtime.cgocallbackg cgocall.go:233
 at runtime.cgocallback asm_amd64.s:971
 at runtime.goexit asm_amd64.s:1571
04:50:09.980556 [debug] [Thread-9  ]: use_qvci set to : false
04:50:09.982846 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:09.983415 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: 
04:50:09.984894 [debug] [Thread-9  ]: SQL status: OK in 0.0 seconds
04:50:09.985468 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:09.986039 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:10.860753 [debug] [Thread-9  ]: SQL status: OK in 0.87 seconds
04:50:10.868401 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:10.869503 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

        
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp"
  
    AS (
      SELECT * FROM (
        WITH snapshot_query AS (

        
    
    select * from "test16653772591959782753_test_basic"."added"

    ),

    snapshotted_data AS (

        SELECT snapshot.*,
            id AS dbt_unique_key

        FROM "test16653772591959782753_test_basic"."cc_date_snapshot" AS snapshot

    ),

    insertions_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00') AS dbt_valid_from,
            nullif(TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00')) AS dbt_valid_to,
            HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id

        FROM snapshot_query
    ),

    updates_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00') AS dbt_valid_from,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:07.540000+00:00') AS dbt_valid_to

        FROM snapshot_query
    ),

    insertions AS (

        SELECT
            'insert' AS dbt_change_type,
            source_data.*

        FROM insertions_source_data AS source_data
        LEFT OUTER JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_unique_key IS NULL
           OR (
                snapshotted_data.dbt_unique_key IS NOT NULL
            AND snapshotted_data.dbt_valid_to IS NULL
            AND (
                (snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
            )
        )

    ),

    updates AS (

        SELECT
            'update' AS dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        FROM updates_source_data AS source_data
        JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_valid_to IS NULL
        AND (
            (snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
        )
    )

    SELECT * FROM insertions
    UNION ALL
    SELECT * FROM updates
      ) D
    ) WITH DATA
  
  ;


    
04:50:11.679964 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:11.682564 [debug] [Thread-9  ]: use_qvci set to : false
04:50:11.684130 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:11.684654 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:12.502848 [debug] [Thread-9  ]: SQL status: OK in 0.82 seconds
04:50:12.509957 [debug] [Thread-9  ]: use_qvci set to : false
04:50:12.512233 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:12.512805 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:13.421165 [debug] [Thread-9  ]: SQL status: OK in 0.91 seconds
04:50:13.428737 [debug] [Thread-9  ]: use_qvci set to : false
04:50:13.431362 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:13.432513 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:14.342444 [debug] [Thread-9  ]: SQL status: OK in 0.91 seconds
04:50:14.348715 [debug] [Thread-9  ]: use_qvci set to : false
04:50:14.350705 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:14.351284 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:15.161743 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:15.174631 [debug] [Thread-9  ]: use_qvci set to : false
04:50:15.178166 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:15.178166 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:15.887276 [debug] [Thread-9  ]: SQL status: OK in 0.71 seconds
04:50:15.893669 [debug] [Thread-9  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:15.895394 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:15.895967 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

          UPDATE "test16653772591959782753_test_basic"."cc_date_snapshot"
    FROM (SELECT dbt_scd_id, dbt_change_type, dbt_valid_to FROM "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp") AS DBT_INTERNAL_SOURCE
    SET dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    WHERE DBT_INTERNAL_SOURCE.dbt_scd_id = "test16653772591959782753_test_basic"."cc_date_snapshot".dbt_scd_id
      AND DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
      AND "test16653772591959782753_test_basic"."cc_date_snapshot".dbt_valid_to IS NULL

      
04:50:16.697806 [debug] [Thread-9  ]: SQL status: OK in 0.8 seconds
04:50:16.700225 [debug] [Thread-9  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:16.703060 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:16.704014 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

          INSERT INTO "test16653772591959782753_test_basic"."cc_date_snapshot" ("id", "name", "some_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    SELECT DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."some_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    FROM "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp" AS DBT_INTERNAL_SOURCE
    WHERE DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
04:50:17.516974 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:17.518625 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
04:50:17.519261 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:50:17.519261 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
04:50:17.929962 [debug] [Thread-9  ]: SQL status: OK in 0.41 seconds
04:50:17.932101 [debug] [Thread-9  ]: finished collecting timing info
04:50:17.932973 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: Close
04:50:18.336347 [info ] [Thread-9  ]: 2 of 3 OK snapshotted test16653772591959782753_test_basic.cc_date_snapshot ..... [[32mOK[0m in 13.62s]
04:50:18.336895 [debug] [Thread-9  ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:50:18.337445 [debug] [Thread-9  ]: Began running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:50:18.337999 [info ] [Thread-9  ]: 3 of 3 START snapshot test16653772591959782753_test_basic.cc_name_snapshot ..... [RUN]
04:50:18.338538 [debug] [Thread-9  ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:18.339246 [debug] [Thread-9  ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:50:18.339246 [debug] [Thread-9  ]: Compiling snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:50:18.343134 [debug] [Thread-9  ]: finished collecting timing info
04:50:18.343681 [debug] [Thread-9  ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:50:18.346637 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:18.347196 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:50:18.347196 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
04:50:22.740627 [debug] [Thread-9  ]: SQL status: OK in 4.39 seconds
04:50:22.749567 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:22.750649 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:50:23.536799 [debug] [Thread-9  ]: SQL status: OK in 0.79 seconds
04:50:23.546119 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:23.546503 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
DROP table /*+ IF EXISTS */ "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp";
04:50:23.952560 [debug] [Thread-9  ]: teradata adapter: Teradata error: [Version 17.20.0.5] [Session 2204] [Teradata Database] [Error 3807] Object 'test16653772591959782753_test_basic.cc_name_snapshot__dbt_tmp' does not exist.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:88
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:216
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:232
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:803
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2229
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:814
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:673
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1307
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1759
 at database/sql.withLock sql.go:3437
 at database/sql.(*DB).queryDC sql.go:1754
 at database/sql.(*Conn).QueryContext sql.go:2013
 at main.goCreateRows goside.go:666
 at _cgoexp_7cdf4597d74c_goCreateRows _cgo_gotypes.go:340
 at runtime.cgocallbackg1 cgocall.go:314
 at runtime.cgocallbackg cgocall.go:233
 at runtime.cgocallback asm_amd64.s:971
 at runtime.goexit asm_amd64.s:1571
04:50:23.955906 [debug] [Thread-9  ]: use_qvci set to : false
04:50:23.957661 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:23.958272 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: 
04:50:23.958793 [debug] [Thread-9  ]: SQL status: OK in 0.0 seconds
04:50:23.959345 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:23.959869 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:24.793557 [debug] [Thread-9  ]: SQL status: OK in 0.83 seconds
04:50:24.801102 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:24.802113 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

        
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp"
  
    AS (
      SELECT * FROM (
        WITH snapshot_query AS (

        
    
    select * from "test16653772591959782753_test_basic"."added"

    ),

    snapshotted_data AS (

        SELECT snapshot.*,
            id AS dbt_unique_key

        FROM "test16653772591959782753_test_basic"."cc_name_snapshot" AS snapshot

    ),

    insertions_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00') AS dbt_valid_from,
            nullif(TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00')) AS dbt_valid_to,
            HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id

        FROM snapshot_query
    ),

    updates_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00') AS dbt_valid_from,
            TO_TIMESTAMP_TZ('2022-10-09 21:50:21.310000+00:00') AS dbt_valid_to

        FROM snapshot_query
    ),

    insertions AS (

        SELECT
            'insert' AS dbt_change_type,
            source_data.*

        FROM insertions_source_data AS source_data
        LEFT OUTER JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_unique_key IS NULL
           OR (
                snapshotted_data.dbt_unique_key IS NOT NULL
            AND snapshotted_data.dbt_valid_to IS NULL
            AND (
                (snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ))
            )
        )

    ),

    updates AS (

        SELECT
            'update' AS dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        FROM updates_source_data AS source_data
        JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_valid_to IS NULL
        AND (
            (snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ))
        )
    )

    SELECT * FROM insertions
    UNION ALL
    SELECT * FROM updates
      ) D
    ) WITH DATA
  
  ;


    
04:50:25.606580 [debug] [Thread-9  ]: SQL status: OK in 0.8 seconds
04:50:25.609047 [debug] [Thread-9  ]: use_qvci set to : false
04:50:25.610659 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:25.611016 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:26.425750 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:26.432413 [debug] [Thread-9  ]: use_qvci set to : false
04:50:26.433513 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:26.434210 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:27.245114 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:27.248457 [debug] [Thread-9  ]: use_qvci set to : false
04:50:27.250090 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:27.250640 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:28.064340 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:28.067947 [debug] [Thread-9  ]: use_qvci set to : false
04:50:28.069297 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:28.069865 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:28.883750 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:28.891022 [debug] [Thread-9  ]: use_qvci set to : false
04:50:28.892634 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:28.893248 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:50:29.602835 [debug] [Thread-9  ]: SQL status: OK in 0.71 seconds
04:50:29.606442 [debug] [Thread-9  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:29.607993 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:29.607993 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

          UPDATE "test16653772591959782753_test_basic"."cc_name_snapshot"
    FROM (SELECT dbt_scd_id, dbt_change_type, dbt_valid_to FROM "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp") AS DBT_INTERNAL_SOURCE
    SET dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    WHERE DBT_INTERNAL_SOURCE.dbt_scd_id = "test16653772591959782753_test_basic"."cc_name_snapshot".dbt_scd_id
      AND DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
      AND "test16653772591959782753_test_basic"."cc_name_snapshot".dbt_valid_to IS NULL

      
04:50:30.423780 [debug] [Thread-9  ]: SQL status: OK in 0.81 seconds
04:50:30.426016 [debug] [Thread-9  ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:30.427975 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:30.428827 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

          INSERT INTO "test16653772591959782753_test_basic"."cc_name_snapshot" ("id", "name", "some_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    SELECT DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."some_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    FROM "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp" AS DBT_INTERNAL_SOURCE
    WHERE DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
04:50:31.152949 [debug] [Thread-9  ]: SQL status: OK in 0.72 seconds
04:50:31.154417 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
04:50:31.154931 [debug] [Thread-9  ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:50:31.155441 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
04:50:31.463928 [debug] [Thread-9  ]: SQL status: OK in 0.31 seconds
04:50:31.466138 [debug] [Thread-9  ]: finished collecting timing info
04:50:31.466755 [debug] [Thread-9  ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: Close
04:50:31.815513 [info ] [Thread-9  ]: 3 of 3 OK snapshotted test16653772591959782753_test_basic.cc_name_snapshot ..... [[32mOK[0m in 13.48s]
04:50:31.817382 [debug] [Thread-9  ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:50:31.820844 [debug] [MainThread]: Acquiring new teradata connection "master"
04:50:31.822511 [debug] [MainThread]: Using teradata connection "master"
04:50:31.823507 [debug] [MainThread]: On master: 
04:50:31.824874 [debug] [MainThread]: Opening a new connection, currently in state closed
04:50:35.438052 [debug] [MainThread]: SQL status: OK in 3.61 seconds
04:50:35.439211 [debug] [MainThread]: On master: COMMIT
04:50:35.440292 [debug] [MainThread]: Using teradata connection "master"
04:50:35.440906 [debug] [MainThread]: On master: COMMIT
04:50:35.753017 [debug] [MainThread]: SQL status: OK in 0.31 seconds
04:50:35.753740 [debug] [MainThread]: On master: Close
04:50:36.101490 [info ] [MainThread]: 
04:50:36.102654 [info ] [MainThread]: Finished running 3 snapshots in 60.63s.
04:50:36.103790 [debug] [MainThread]: Connection 'master' was properly closed.
04:50:36.104376 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
04:50:36.105483 [debug] [MainThread]: Connection 'list_None_test16653772591959782753_test_basic' was properly closed.
04:50:36.106535 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_name_snapshot' was properly closed.
04:50:36.117739 [info ] [MainThread]: 
04:50:36.119247 [info ] [MainThread]: [32mCompleted successfully[0m
04:50:36.120244 [info ] [MainThread]: 
04:50:36.121640 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
04:50:36.124101 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:50:36.125311 [debug] [MainThread]: Opening a new connection, currently in state init
04:50:40.249859 [debug] [MainThread]: On _test: Close
04:50:40.666789 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:50:40.762278 [debug] [MainThread]: Opening a new connection, currently in state closed
04:50:45.062643 [debug] [MainThread]: On _test: Close
04:50:45.472454 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:50:45.473003 [debug] [MainThread]: Opening a new connection, currently in state closed
04:50:49.978246 [debug] [MainThread]: On _test: Close
04:50:50.387847 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:50:50.388914 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:50:50.389507 [debug] [MainThread]: Using teradata connection "_test"
04:50:50.389507 [debug] [MainThread]: On _test: 
04:50:50.390055 [debug] [MainThread]: Opening a new connection, currently in state closed
04:50:54.074239 [debug] [MainThread]: SQL status: OK in 3.68 seconds
04:50:54.074793 [debug] [MainThread]: Using teradata connection "_test"
04:50:54.074954 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
update "test16653772591959782753_test_basic"."added" set some_date = some_date + interval '1' hour where id > 10 and id < 21
04:50:54.893410 [debug] [MainThread]: SQL status: OK in 0.82 seconds
04:50:54.894100 [debug] [MainThread]: On _test: COMMIT
04:50:54.894918 [debug] [MainThread]: Using teradata connection "_test"
04:50:54.894918 [debug] [MainThread]: On _test: COMMIT
04:50:55.303726 [debug] [MainThread]: SQL status: OK in 0.41 seconds
04:50:55.304239 [debug] [MainThread]: On _test: Close
04:50:55.845169 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-10 04:50:55.857281 | 4a2abe90-d4de-4a58-a5b8-c18c57e3a4d2 ==============================
04:50:55.857281 [info ] [MainThread]: Running with dbt=1.1.0
04:50:55.857281 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\vs255034\\AppData\\Local\\Temp\\pytest-of-vs255034\\pytest-20\\profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': 'seed_name: added', 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
04:50:55.858311 [debug] [MainThread]: Tracking: do not track
04:50:55.933301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
04:50:55.934398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
04:50:55.945098 [info ] [MainThread]: Found 0 models, 0 tests, 3 snapshots, 0 analyses, 181 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
04:50:55.947128 [info ] [MainThread]: 
04:50:55.947128 [debug] [MainThread]: Acquiring new teradata connection "master"
04:50:55.949089 [debug] [ThreadPool]: Acquiring new teradata connection "list_schemas"
04:50:55.950742 [debug] [ThreadPool]: Using teradata connection "list_schemas"
04:50:55.951741 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_schemas"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:50:55.951741 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:51:01.143111 [debug] [ThreadPool]: SQL status: OK in 5.19 seconds
04:51:01.145687 [debug] [ThreadPool]: On list_schemas: Close
04:51:01.463773 [debug] [ThreadPool]: Acquiring new teradata connection "list_None_test16653772591959782753_test_basic"
04:51:01.466876 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:51:01.467403 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: 
04:51:01.467921 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:51:04.928926 [debug] [ThreadPool]: SQL status: OK in 3.46 seconds
04:51:04.929537 [debug] [ThreadPool]: Using teradata connection "list_None_test16653772591959782753_test_basic"
04:51:04.930053 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "list_None_test16653772591959782753_test_basic"} */
SELECT
      NULL AS "database",
      TableName AS name,
      DatabaseName AS "schema",
      CASE WHEN TableKind = 'T' THEN 'table'
        WHEN TableKind = 'O' THEN 'table'
        WHEN TableKind = 'V' THEN 'view'
        ELSE TableKind
      END AS table_type
    FROM DBC.TablesV
    WHERE DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND TableKind IN ('T', 'V', 'O')

  
04:51:05.653180 [debug] [ThreadPool]: SQL status: OK in 0.72 seconds
04:51:05.655260 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: ROLLBACK
04:51:05.973612 [debug] [ThreadPool]: On list_None_test16653772591959782753_test_basic: Close
04:51:06.294381 [debug] [MainThread]: Using teradata connection "master"
04:51:06.295427 [debug] [MainThread]: On master: 
04:51:06.296424 [debug] [MainThread]: Opening a new connection, currently in state init
04:51:09.844466 [debug] [MainThread]: SQL status: OK in 3.55 seconds
04:51:09.845780 [debug] [MainThread]: On master: COMMIT
04:51:09.846961 [debug] [MainThread]: Using teradata connection "master"
04:51:09.848043 [debug] [MainThread]: On master: COMMIT
04:51:10.169861 [debug] [MainThread]: SQL status: OK in 0.32 seconds
04:51:10.170948 [debug] [MainThread]: On master: Close
04:51:10.476865 [info ] [MainThread]: Concurrency: 1 threads (target='default')
04:51:10.478922 [info ] [MainThread]: 
04:51:10.483018 [debug] [Thread-13 ]: Began running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:51:10.484727 [info ] [Thread-13 ]: 1 of 3 START snapshot test16653772591959782753_test_basic.cc_all_snapshot ...... [RUN]
04:51:10.486509 [debug] [Thread-13 ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:10.487475 [debug] [Thread-13 ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:51:10.487579 [debug] [Thread-13 ]: Compiling snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:51:10.495518 [debug] [Thread-13 ]: finished collecting timing info
04:51:10.496518 [debug] [Thread-13 ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:51:10.503971 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:10.504926 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:51:10.504926 [debug] [Thread-13 ]: Opening a new connection, currently in state init
04:51:14.384269 [debug] [Thread-13 ]: SQL status: OK in 3.88 seconds
04:51:14.392660 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:14.393205 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:51:15.013373 [debug] [Thread-13 ]: SQL status: OK in 0.62 seconds
04:51:15.015697 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:15.016254 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT * FROM (
            
    
    select * from "test16653772591959782753_test_basic"."added"
        ) AS __dbt_sbq
        WHERE 0=1
    
04:51:15.633541 [debug] [Thread-13 ]: SQL status: OK in 0.62 seconds
04:51:15.638343 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:15.638872 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
SELECT * FROM (
            SELECT * FROM "test16653772591959782753_test_basic"."cc_all_snapshot"
        ) AS __dbt_sbq
        WHERE 0=1
    
04:51:16.263404 [debug] [Thread-13 ]: SQL status: OK in 0.62 seconds
04:51:16.271960 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:16.272538 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
DROP table /*+ IF EXISTS */ "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp";
04:51:16.934125 [debug] [Thread-13 ]: SQL status: OK in 0.66 seconds
04:51:16.938965 [debug] [Thread-13 ]: use_qvci set to : false
04:51:16.940115 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:16.941258 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: 
04:51:16.941804 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
04:51:16.941808 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:16.942357 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:17.593353 [debug] [Thread-13 ]: SQL status: OK in 0.65 seconds
04:51:17.596745 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:17.597297 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

        
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp"
  
    AS (
      SELECT * FROM (
        WITH snapshot_query AS (

        
    
    select * from "test16653772591959782753_test_basic"."added"

    ),

    snapshotted_data AS (

        SELECT snapshot.*,
            id AS dbt_unique_key

        FROM "test16653772591959782753_test_basic"."cc_all_snapshot" AS snapshot

    ),

    insertions_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00') AS dbt_valid_from,
            nullif(TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00')) AS dbt_valid_to,
            HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id

        FROM snapshot_query
    ),

    updates_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00') AS dbt_valid_from,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:12.960000+00:00') AS dbt_valid_to

        FROM snapshot_query
    ),

    insertions AS (

        SELECT
            'insert' AS dbt_change_type,
            source_data.*

        FROM insertions_source_data AS source_data
        LEFT OUTER JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_unique_key IS NULL
           OR (
                snapshotted_data.dbt_unique_key IS NOT NULL
            AND snapshotted_data.dbt_valid_to IS NULL
            AND (
                (snapshotted_data.id <> source_data.id
        or
        (
            ((snapshotted_data.id IS NULL) AND NOT (source_data.id IS NULL))
            OR
            ((NOT snapshotted_data.id IS NULL) AND (source_data.id IS NULL))
        ) OR snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ) OR snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
            )
        )

    ),

    updates AS (

        SELECT
            'update' AS dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        FROM updates_source_data AS source_data
        JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_valid_to IS NULL
        AND (
            (snapshotted_data.id <> source_data.id
        or
        (
            ((snapshotted_data.id IS NULL) AND NOT (source_data.id IS NULL))
            OR
            ((NOT snapshotted_data.id IS NULL) AND (source_data.id IS NULL))
        ) OR snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ) OR snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
        )
    )

    SELECT * FROM insertions
    UNION ALL
    SELECT * FROM updates
      ) D
    ) WITH DATA
  
  ;


    
04:51:18.343474 [debug] [Thread-13 ]: SQL status: OK in 0.75 seconds
04:51:18.346902 [debug] [Thread-13 ]: use_qvci set to : false
04:51:18.348874 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:18.349473 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:18.993436 [debug] [Thread-13 ]: SQL status: OK in 0.64 seconds
04:51:18.998419 [debug] [Thread-13 ]: use_qvci set to : false
04:51:18.999555 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:19.000361 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:19.643420 [debug] [Thread-13 ]: SQL status: OK in 0.64 seconds
04:51:19.647988 [debug] [Thread-13 ]: use_qvci set to : false
04:51:19.649654 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:19.650214 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:20.293455 [debug] [Thread-13 ]: SQL status: OK in 0.64 seconds
04:51:20.297618 [debug] [Thread-13 ]: use_qvci set to : false
04:51:20.298563 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:20.299296 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:20.943982 [debug] [Thread-13 ]: SQL status: OK in 0.64 seconds
04:51:20.950466 [debug] [Thread-13 ]: use_qvci set to : false
04:51:20.952079 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:20.952563 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_all_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:21.604595 [debug] [Thread-13 ]: SQL status: OK in 0.65 seconds
04:51:21.611620 [debug] [Thread-13 ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:21.613290 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:21.614428 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

          UPDATE "test16653772591959782753_test_basic"."cc_all_snapshot"
    FROM (SELECT dbt_scd_id, dbt_change_type, dbt_valid_to FROM "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp") AS DBT_INTERNAL_SOURCE
    SET dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    WHERE DBT_INTERNAL_SOURCE.dbt_scd_id = "test16653772591959782753_test_basic"."cc_all_snapshot".dbt_scd_id
      AND DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
      AND "test16653772591959782753_test_basic"."cc_all_snapshot".dbt_valid_to IS NULL

      
04:51:22.263467 [debug] [Thread-13 ]: SQL status: OK in 0.65 seconds
04:51:22.265120 [debug] [Thread-13 ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:22.266357 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:22.266913 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

          INSERT INTO "test16653772591959782753_test_basic"."cc_all_snapshot" ("id", "name", "some_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    SELECT DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."some_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    FROM "test16653772591959782753_test_basic"."cc_all_snapshot__dbt_tmp" AS DBT_INTERNAL_SOURCE
    WHERE DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
04:51:22.929299 [debug] [Thread-13 ]: SQL status: OK in 0.66 seconds
04:51:22.935072 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
04:51:22.936390 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
04:51:22.937526 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
04:51:23.254537 [debug] [Thread-13 ]: SQL status: OK in 0.32 seconds
04:51:23.257728 [debug] [Thread-13 ]: finished collecting timing info
04:51:23.258706 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: Close
04:51:23.589327 [info ] [Thread-13 ]: 1 of 3 OK snapshotted test16653772591959782753_test_basic.cc_all_snapshot ...... [[32mOK[0m in 13.10s]
04:51:23.591655 [debug] [Thread-13 ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
04:51:23.593174 [debug] [Thread-13 ]: Began running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:51:23.594255 [info ] [Thread-13 ]: 2 of 3 START snapshot test16653772591959782753_test_basic.cc_date_snapshot ..... [RUN]
04:51:23.597107 [debug] [Thread-13 ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:23.598228 [debug] [Thread-13 ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:51:23.598747 [debug] [Thread-13 ]: Compiling snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:51:23.601250 [debug] [Thread-13 ]: finished collecting timing info
04:51:23.601250 [debug] [Thread-13 ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:51:23.606759 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:23.606759 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:51:23.610454 [debug] [Thread-13 ]: Opening a new connection, currently in state closed
04:51:27.439490 [debug] [Thread-13 ]: SQL status: OK in 3.83 seconds
04:51:27.443907 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:27.444473 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:51:28.074653 [debug] [Thread-13 ]: SQL status: OK in 0.63 seconds
04:51:28.083799 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:28.084633 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
DROP table /*+ IF EXISTS */ "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp";
04:51:28.733893 [debug] [Thread-13 ]: SQL status: OK in 0.65 seconds
04:51:28.736869 [debug] [Thread-13 ]: use_qvci set to : false
04:51:28.738624 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:28.739145 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: 
04:51:28.739650 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
04:51:28.739732 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:28.740440 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:29.384101 [debug] [Thread-13 ]: SQL status: OK in 0.64 seconds
04:51:29.388369 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:29.388906 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

        
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp"
  
    AS (
      SELECT * FROM (
        WITH snapshot_query AS (

        
    
    select * from "test16653772591959782753_test_basic"."added"

    ),

    snapshotted_data AS (

        SELECT snapshot.*,
            id AS dbt_unique_key

        FROM "test16653772591959782753_test_basic"."cc_date_snapshot" AS snapshot

    ),

    insertions_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00') AS dbt_valid_from,
            nullif(TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00')) AS dbt_valid_to,
            HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id

        FROM snapshot_query
    ),

    updates_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00') AS dbt_valid_from,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:26.010000+00:00') AS dbt_valid_to

        FROM snapshot_query
    ),

    insertions AS (

        SELECT
            'insert' AS dbt_change_type,
            source_data.*

        FROM insertions_source_data AS source_data
        LEFT OUTER JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_unique_key IS NULL
           OR (
                snapshotted_data.dbt_unique_key IS NOT NULL
            AND snapshotted_data.dbt_valid_to IS NULL
            AND (
                (snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
            )
        )

    ),

    updates AS (

        SELECT
            'update' AS dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        FROM updates_source_data AS source_data
        JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_valid_to IS NULL
        AND (
            (snapshotted_data.some_date <> source_data.some_date
        or
        (
            ((snapshotted_data.some_date IS NULL) AND NOT (source_data.some_date IS NULL))
            OR
            ((NOT snapshotted_data.some_date IS NULL) AND (source_data.some_date IS NULL))
        ))
        )
    )

    SELECT * FROM insertions
    UNION ALL
    SELECT * FROM updates
      ) D
    ) WITH DATA
  
  ;


    
04:51:30.114095 [debug] [Thread-13 ]: SQL status: OK in 0.73 seconds
04:51:30.118745 [debug] [Thread-13 ]: use_qvci set to : false
04:51:30.119988 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:30.120536 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:30.764040 [debug] [Thread-13 ]: SQL status: OK in 0.64 seconds
04:51:30.768644 [debug] [Thread-13 ]: use_qvci set to : false
04:51:30.770488 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:30.771006 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:31.450741 [debug] [Thread-13 ]: SQL status: OK in 0.68 seconds
04:51:31.457543 [debug] [Thread-13 ]: use_qvci set to : false
04:51:31.459503 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:31.460150 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:32.167933 [debug] [Thread-13 ]: SQL status: OK in 0.71 seconds
04:51:32.175382 [debug] [Thread-13 ]: use_qvci set to : false
04:51:32.180967 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:32.182238 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:32.885246 [debug] [Thread-13 ]: SQL status: OK in 0.7 seconds
04:51:32.895520 [debug] [Thread-13 ]: use_qvci set to : false
04:51:32.897129 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:32.897655 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_date_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:33.704171 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:33.709280 [debug] [Thread-13 ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:33.710382 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:33.710382 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

          UPDATE "test16653772591959782753_test_basic"."cc_date_snapshot"
    FROM (SELECT dbt_scd_id, dbt_change_type, dbt_valid_to FROM "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp") AS DBT_INTERNAL_SOURCE
    SET dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    WHERE DBT_INTERNAL_SOURCE.dbt_scd_id = "test16653772591959782753_test_basic"."cc_date_snapshot".dbt_scd_id
      AND DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
      AND "test16653772591959782753_test_basic"."cc_date_snapshot".dbt_valid_to IS NULL

      
04:51:34.523169 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:34.525030 [debug] [Thread-13 ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:34.528451 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:34.529458 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

          INSERT INTO "test16653772591959782753_test_basic"."cc_date_snapshot" ("id", "name", "some_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    SELECT DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."some_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    FROM "test16653772591959782753_test_basic"."cc_date_snapshot__dbt_tmp" AS DBT_INTERNAL_SOURCE
    WHERE DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
04:51:35.342648 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:35.346461 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
04:51:35.347317 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
04:51:35.347881 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
04:51:35.661169 [debug] [Thread-13 ]: SQL status: OK in 0.31 seconds
04:51:35.663852 [debug] [Thread-13 ]: finished collecting timing info
04:51:35.664653 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: Close
04:51:36.060026 [info ] [Thread-13 ]: 2 of 3 OK snapshotted test16653772591959782753_test_basic.cc_date_snapshot ..... [[32mOK[0m in 12.46s]
04:51:36.061372 [debug] [Thread-13 ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
04:51:36.062421 [debug] [Thread-13 ]: Began running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:51:36.063408 [info ] [Thread-13 ]: 3 of 3 START snapshot test16653772591959782753_test_basic.cc_name_snapshot ..... [RUN]
04:51:36.064867 [debug] [Thread-13 ]: Acquiring new teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:36.065416 [debug] [Thread-13 ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:51:36.066242 [debug] [Thread-13 ]: Compiling snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:51:36.070796 [debug] [Thread-13 ]: finished collecting timing info
04:51:36.070796 [debug] [Thread-13 ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:51:36.079696 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:36.079696 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
SELECT DatabaseName AS schema_name
        FROM DBC.DatabasesV
04:51:36.083109 [debug] [Thread-13 ]: Opening a new connection, currently in state closed
04:51:40.362959 [debug] [Thread-13 ]: SQL status: OK in 4.28 seconds
04:51:40.368345 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:40.368855 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT CURRENT_TIMESTAMP(6) AS snapshot_start
  
04:51:41.179074 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:41.184404 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:41.185473 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
DROP table /*+ IF EXISTS */ "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp";
04:51:41.873711 [debug] [Thread-13 ]: SQL status: OK in 0.69 seconds
04:51:41.879731 [debug] [Thread-13 ]: use_qvci set to : false
04:51:41.883308 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:41.884229 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: 
04:51:41.885687 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
04:51:41.887076 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:41.887848 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:42.716600 [debug] [Thread-13 ]: SQL status: OK in 0.83 seconds
04:51:42.722470 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:42.723067 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

        
  CREATE  TABLE
  "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp"
  
    AS (
      SELECT * FROM (
        WITH snapshot_query AS (

        
    
    select * from "test16653772591959782753_test_basic"."added"

    ),

    snapshotted_data AS (

        SELECT snapshot.*,
            id AS dbt_unique_key

        FROM "test16653772591959782753_test_basic"."cc_name_snapshot" AS snapshot

    ),

    insertions_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00') AS dbt_valid_from,
            nullif(TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00'), TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00')) AS dbt_valid_to,
            HASHROW(coalesce(cast(id AS VARCHAR(50) ), '')
         || '|' || coalesce(cast(TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00') AS VARCHAR(50) ), '')
        ) AS dbt_scd_id

        FROM snapshot_query
    ),

    updates_source_data AS (

        SELECT
            snapshot_query.*,
            id AS dbt_unique_key,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00') AS dbt_updated_at,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00') AS dbt_valid_from,
            TO_TIMESTAMP_TZ('2022-10-09 21:51:38.930000+00:00') AS dbt_valid_to

        FROM snapshot_query
    ),

    insertions AS (

        SELECT
            'insert' AS dbt_change_type,
            source_data.*

        FROM insertions_source_data AS source_data
        LEFT OUTER JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_unique_key IS NULL
           OR (
                snapshotted_data.dbt_unique_key IS NOT NULL
            AND snapshotted_data.dbt_valid_to IS NULL
            AND (
                (snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ))
            )
        )

    ),

    updates AS (

        SELECT
            'update' AS dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        FROM updates_source_data AS source_data
        JOIN snapshotted_data ON snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        WHERE snapshotted_data.dbt_valid_to IS NULL
        AND (
            (snapshotted_data.name <> source_data.name
        or
        (
            ((snapshotted_data.name IS NULL) AND NOT (source_data.name IS NULL))
            OR
            ((NOT snapshotted_data.name IS NULL) AND (source_data.name IS NULL))
        ))
        )
    )

    SELECT * FROM insertions
    UNION ALL
    SELECT * FROM updates
      ) D
    ) WITH DATA
  
  ;


    
04:51:43.535682 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:43.539446 [debug] [Thread-13 ]: use_qvci set to : false
04:51:43.541228 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:43.541902 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:44.353774 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:44.361654 [debug] [Thread-13 ]: use_qvci set to : false
04:51:44.364508 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:44.365086 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:45.173276 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:45.179081 [debug] [Thread-13 ]: use_qvci set to : false
04:51:45.180343 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:45.180859 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:45.992645 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:45.999586 [debug] [Thread-13 ]: use_qvci set to : false
04:51:46.000788 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:46.001399 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:46.811132 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:46.815375 [debug] [Thread-13 ]: use_qvci set to : false
04:51:46.816959 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:46.817476 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    SELECT
      ColumnsV.ColumnName AS "column",
      CASE
        WHEN ColumnsV.ColumnType = '++' THEN 'TD_ANYTYPE'
        WHEN ColumnsV.ColumnType = 'A1' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'AN' THEN 'ARRAY'
        WHEN ColumnsV.ColumnType = 'I8' THEN 'BIGINT'
        WHEN ColumnsV.ColumnType = 'BO' THEN 'BINARY LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'BF' THEN 'BYTE'
        WHEN ColumnsV.ColumnType = 'BV' THEN 'BYTE VARYING'
        WHEN ColumnsV.ColumnType = 'I1' THEN 'BYTEINT'
        WHEN ColumnsV.ColumnType = 'CF' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CV' THEN 'CHARACTER'
        WHEN ColumnsV.ColumnType = 'CO' THEN 'CHARACTER LARGE OBJECT'
        WHEN ColumnsV.ColumnType = 'D' THEN 'DECIMAL'
        WHEN ColumnsV.ColumnType = 'DA' THEN 'DATE'
        WHEN ColumnsV.ColumnType = 'F' THEN 'DOUBLE PRECISION'
        WHEN ColumnsV.ColumnType = 'I' THEN 'INTEGER'
        WHEN ColumnsV.ColumnType = 'DY' THEN 'INTERVAL DAY'
        WHEN ColumnsV.ColumnType = 'DH' THEN 'INTERVAL DAY TO HOUR'
        WHEN ColumnsV.ColumnType = 'DM' THEN 'INTERVAL DAY TO MINUTE'
        WHEN ColumnsV.ColumnType = 'DS' THEN 'INTERVAL DAY TO SECOND'
        WHEN ColumnsV.ColumnType = 'HR' THEN 'INTERVAL HOUR'
        WHEN ColumnsV.ColumnType = 'HM' THEN 'INTERVAL HOUR TO MINUTE'
        WHEN ColumnsV.ColumnType = 'HS' THEN 'INTERVAL HOUR TO SECOND'
        WHEN ColumnsV.ColumnType = 'MI' THEN 'INTERVAL MINUTE'
        WHEN ColumnsV.ColumnType = 'MS' THEN 'INTERVAL MINUTE TO SECOND'
        WHEN ColumnsV.ColumnType = 'MO' THEN 'INTERVAL MONTH'
        WHEN ColumnsV.ColumnType = 'SC' THEN 'INTERVAL SECOND'
        WHEN ColumnsV.ColumnType = 'YR' THEN 'INTERVAL YEAR'
        WHEN ColumnsV.ColumnType = 'YM' THEN 'INTERVAL YEAR TO MONTH'
        WHEN ColumnsV.ColumnType = 'N' THEN 'NUMBER'
        WHEN ColumnsV.ColumnType = 'D' THEN 'NUMERIC'
        WHEN ColumnsV.ColumnType = 'PD' THEN 'PERIOD(DATE)'
        WHEN ColumnsV.ColumnType = 'PT' THEN 'PERIOD(TIME(n))'
        WHEN ColumnsV.ColumnType = 'PZ' THEN 'PERIOD(TIME(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'PS' THEN 'PERIOD(TIMESTAMP(n))'
        WHEN ColumnsV.ColumnType = 'PM' THEN 'PERIOD(TIMESTAMP(n) WITH TIME ZONE)'
        WHEN ColumnsV.ColumnType = 'F' THEN 'REAL'
        WHEN ColumnsV.ColumnType = 'I2' THEN 'SMALLINT'
        WHEN ColumnsV.ColumnType = 'AT' THEN 'TIME'
        WHEN ColumnsV.ColumnType = 'TS' THEN 'TIMESTAMP'
        WHEN ColumnsV.ColumnType = 'TZ' THEN 'TIME WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'SZ' THEN 'TIMESTAMP WITH TIME ZONE'
        WHEN ColumnsV.ColumnType = 'UT' THEN 'USER‑DEFINED TYPE'
        WHEN ColumnsV.ColumnType = 'XM' THEN 'XML'
        ELSE 'N/A'
      END AS dtype,
      CASE
        WHEN ColumnsV.CharType = 1 THEN ColumnsV.ColumnLength
      END AS char_size,
      ColumnsV.DecimalTotalDigits AS numeric_precision,
      ColumnsV.DecimalFractionalDigits AS numeric_scale,
      NULL AS table_database,
      ColumnsV.DatabaseName AS table_schema,
      ColumnsV.TableName AS table_name,
      CASE WHEN TablesV.TableKind = 'T' THEN 'table'
        WHEN TablesV.TableKind = 'O' THEN 'table'
        WHEN TablesV.TableKind = 'V' THEN 'view'
        ELSE TablesV.TableKind
      END AS table_type,
      ColumnsV.ColumnID AS column_index
    FROM
    
      DBC.ColumnsV
    LEFT OUTER JOIN DBC.TablesV
      ON ColumnsV.DatabaseName = TablesV.DatabaseName
      AND ColumnsV.TableName = TablesV.TableName
    WHERE
      TablesV.TableKind IN ('T', 'V', 'O')
      AND ColumnsV.DatabaseName = 'test16653772591959782753_test_basic' (NOT CASESPECIFIC)
      AND ColumnsV.TableName = 'cc_name_snapshot__dbt_tmp' (NOT CASESPECIFIC)
    ORDER BY
      ColumnsV.ColumnID
    
04:51:47.630800 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:47.637992 [debug] [Thread-13 ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:47.639285 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:47.639800 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

          UPDATE "test16653772591959782753_test_basic"."cc_name_snapshot"
    FROM (SELECT dbt_scd_id, dbt_change_type, dbt_valid_to FROM "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp") AS DBT_INTERNAL_SOURCE
    SET dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    WHERE DBT_INTERNAL_SOURCE.dbt_scd_id = "test16653772591959782753_test_basic"."cc_name_snapshot".dbt_scd_id
      AND DBT_INTERNAL_SOURCE.dbt_change_type = 'update'
      AND "test16653772591959782753_test_basic"."cc_name_snapshot".dbt_valid_to IS NULL

      
04:51:48.451652 [debug] [Thread-13 ]: SQL status: OK in 0.81 seconds
04:51:48.454496 [debug] [Thread-13 ]: Writing runtime SQL for node "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:48.456895 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:48.457971 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

          INSERT INTO "test16653772591959782753_test_basic"."cc_name_snapshot" ("id", "name", "some_date", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    SELECT DBT_INTERNAL_SOURCE."id",DBT_INTERNAL_SOURCE."name",DBT_INTERNAL_SOURCE."some_date",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    FROM "test16653772591959782753_test_basic"."cc_name_snapshot__dbt_tmp" AS DBT_INTERNAL_SOURCE
    WHERE DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'

      
04:51:49.166694 [debug] [Thread-13 ]: SQL status: OK in 0.71 seconds
04:51:49.169679 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
04:51:49.170243 [debug] [Thread-13 ]: Using teradata connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
04:51:49.170764 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
04:51:49.576362 [debug] [Thread-13 ]: SQL status: OK in 0.41 seconds
04:51:49.579561 [debug] [Thread-13 ]: finished collecting timing info
04:51:49.581320 [debug] [Thread-13 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: Close
04:51:49.988094 [info ] [Thread-13 ]: 3 of 3 OK snapshotted test16653772591959782753_test_basic.cc_name_snapshot ..... [[32mOK[0m in 13.92s]
04:51:49.989854 [debug] [Thread-13 ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
04:51:49.992872 [debug] [MainThread]: Acquiring new teradata connection "master"
04:51:49.994063 [debug] [MainThread]: Using teradata connection "master"
04:51:49.995077 [debug] [MainThread]: On master: 
04:51:49.996160 [debug] [MainThread]: Opening a new connection, currently in state closed
04:51:53.705156 [debug] [MainThread]: SQL status: OK in 3.71 seconds
04:51:53.706281 [debug] [MainThread]: On master: COMMIT
04:51:53.707023 [debug] [MainThread]: Using teradata connection "master"
04:51:53.708017 [debug] [MainThread]: On master: COMMIT
04:51:54.023893 [debug] [MainThread]: SQL status: OK in 0.31 seconds
04:51:54.024476 [debug] [MainThread]: On master: Close
04:51:54.389875 [info ] [MainThread]: 
04:51:54.391332 [info ] [MainThread]: Finished running 3 snapshots in 58.44s.
04:51:54.392422 [debug] [MainThread]: Connection 'master' was properly closed.
04:51:54.393520 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
04:51:54.394618 [debug] [MainThread]: Connection 'list_None_test16653772591959782753_test_basic' was properly closed.
04:51:54.395291 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_name_snapshot' was properly closed.
04:51:54.412882 [info ] [MainThread]: 
04:51:54.413879 [info ] [MainThread]: [32mCompleted successfully[0m
04:51:54.416271 [info ] [MainThread]: 
04:51:54.417142 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
04:51:54.419661 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:51:54.421619 [debug] [MainThread]: Opening a new connection, currently in state init
04:51:58.793775 [debug] [MainThread]: On _test: Close
04:51:59.203290 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:51:59.204266 [debug] [MainThread]: Opening a new connection, currently in state closed
04:52:03.299296 [debug] [MainThread]: On _test: Close
04:52:03.709871 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:52:03.711056 [debug] [MainThread]: Opening a new connection, currently in state closed
04:52:08.008531 [debug] [MainThread]: On _test: Close
04:52:08.422615 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:52:08.423733 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:52:08.424258 [debug] [MainThread]: Using teradata connection "_test"
04:52:08.424258 [debug] [MainThread]: On _test: 
04:52:08.424816 [debug] [MainThread]: Opening a new connection, currently in state closed
04:52:11.824002 [debug] [MainThread]: SQL status: OK in 3.4 seconds
04:52:11.825111 [debug] [MainThread]: Using teradata connection "_test"
04:52:11.826221 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
update "test16653772591959782753_test_basic"."added" set name = concat(cast(trim(name) as varchar(63800)), '_updated') where id < 11
04:52:13.026340 [debug] [MainThread]: teradata adapter: Teradata error: [Version 17.20.0.5] [Session 2220] [Teradata Database] [Error 3706] Syntax error: expected something between '(' and the 'cast' keyword.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:88
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:216
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:232
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:803
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2229
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:814
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:673
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1307
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1759
 at database/sql.withLock sql.go:3437
 at database/sql.(*DB).queryDC sql.go:1754
 at database/sql.(*Conn).QueryContext sql.go:2013
 at main.goCreateRows goside.go:666
 at _cgoexp_7cdf4597d74c_goCreateRows _cgo_gotypes.go:340
 at runtime.cgocallbackg1 cgocall.go:314
 at runtime.cgocallbackg cgocall.go:233
 at runtime.cgocallback asm_amd64.s:971
 at runtime.goexit asm_amd64.s:1571
04:52:13.027510 [debug] [MainThread]: On _test: ROLLBACK
04:52:13.436275 [debug] [MainThread]: On _test: Close
04:52:14.509964 [debug] [MainThread]: Acquiring new teradata connection "_test"
04:52:14.510393 [debug] [MainThread]: Dropping schema "_ReferenceKey(database=None, schema='test16653772591959782753_test_basic', identifier=None)".
04:52:14.512926 [debug] [MainThread]: Using teradata connection "_test"
04:52:14.513649 [debug] [MainThread]: On _test: 
04:52:14.513953 [debug] [MainThread]: Opening a new connection, currently in state closed
04:52:17.965900 [debug] [MainThread]: SQL status: OK in 3.45 seconds
04:52:17.967179 [debug] [MainThread]: Using teradata connection "_test"
04:52:17.967795 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
DELETE DATABASE /*+ IF EXISTS */ "test16653772591959782753_test_basic" ALL;
04:52:18.761441 [debug] [MainThread]: SQL status: OK in 0.79 seconds
04:52:18.764262 [debug] [MainThread]: Using teradata connection "_test"
04:52:18.765085 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
DROP DATABASE /*+ IF EXISTS */ "test16653772591959782753_test_basic";
04:52:19.478405 [debug] [MainThread]: SQL status: OK in 0.71 seconds
04:52:19.481257 [debug] [MainThread]: On _test: ROLLBACK
04:52:19.887283 [debug] [MainThread]: On _test: Close
04:52:20.298853 [debug] [MainThread]: Connection '_test' was properly closed.
